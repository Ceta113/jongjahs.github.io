<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì¢…ìì˜ˆìˆ ê³ ë“±í•™êµ ARCHIVE SYSTEM v3.1_FINAL</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=JetBrains+Mono:wght@400;700&family=Noto+Serif+KR:wght@400;700&display=swap" rel="stylesheet">
  
  <style>
    :root {
      --primary: #9333ea;
      --primary-light: #d8b4fe;
      --primary-dim: #4c1d7a;
      --accent: #c084fc;
      --danger: #ff003c;
      --bg-dark: #050505;
      --bg-panel: rgba(20, 20, 25, 0.75);
      --text-main: #e0e0e0;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      background-color: var(--bg-dark);
      color: var(--text-main);
      font-family: 'Noto Sans KR', sans-serif;
      overflow: hidden;
      height: 100vh;
      width: 100vw;
    }

    /* ì»¤ìŠ¤í…€ ìŠ¤í¬ë¡¤ë°” */
    ::-webkit-scrollbar { width: 5px; }
    ::-webkit-scrollbar-track { background: #000; }
    ::-webkit-scrollbar-thumb { background: #444; border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--primary); }

    /* === 1. ë°°ê²½ íš¨ê³¼ === */
    #seed-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; overflow: hidden; }
    .seed { position: absolute; font-size: 20px; filter: hue-rotate(260deg) brightness(1.5) drop-shadow(0 0 8px var(--primary)); opacity: 0; animation: fall linear forwards; }
    @keyframes fall { 0% { transform: translateY(-50px) rotate(0deg); opacity: 0; } 10% { opacity: 0.8; } 100% { transform: translateY(105vh) rotate(360deg); opacity: 0; } }

    /* === 2. ë®¤ì§ í”Œë ˆì´ì–´ (ë¹„ì£¼ì–¼ë¼ì´ì € ì¶”ê°€) === */
    .music-player {
      position: fixed; bottom: 30px; left: 30px; width: 280px;
      background: rgba(10, 10, 15, 0.9); backdrop-filter: blur(10px);
      border: 1px solid rgba(147, 51, 234, 0.3); border-left: 3px solid var(--primary);
      padding: 15px 20px; z-index: 500; display: flex; align-items: center; gap: 15px;
      transition: opacity 1s; opacity: 0; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    }
    
    .album-art { 
      width: 45px; height: 45px; background: linear-gradient(135deg, var(--primary), #000); 
      border-radius: 4px; display: flex; align-items: center; justify-content: center; font-size: 20px; 
    }
    .album-art.playing { animation: spin 4s linear infinite; }
    @keyframes spin { 100% { transform: rotate(360deg); } }

    .track-info { flex: 1; overflow: hidden; }
    .track-title { font-family: 'JetBrains Mono'; font-size: 12px; color: #fff; margin-bottom: 2px; }
    .track-artist { font-size: 10px; color: #888; }
    
    /* ë¹„ì£¼ì–¼ë¼ì´ì € ë°” */
    .visualizer { display: flex; align-items: flex-end; gap: 2px; height: 15px; margin-left: 5px; }
    .bar { width: 3px; background: var(--primary); height: 3px; transition: height 0.1s; }
    .playing .bar { animation: wave 0.5s infinite ease-in-out alternate; }
    .playing .bar:nth-child(1) { animation-delay: 0.1s; }
    .playing .bar:nth-child(2) { animation-delay: 0.3s; }
    .playing .bar:nth-child(3) { animation-delay: 0.0s; }
    .playing .bar:nth-child(4) { animation-delay: 0.2s; }
    @keyframes wave { 0% { height: 3px; } 100% { height: 15px; } }

    .ctrl-btn { background: none; border: none; color: var(--primary-light); cursor: pointer; font-size: 16px; margin-left: 5px; transition: 0.2s; }
    .ctrl-btn:hover { color: #fff; transform: scale(1.1); }

    /* === 3. ë¡œê·¸ì¸ & ë¶€íŒ… === */
    .login-screen {
      position: fixed; top: 0; left: 0; width: 100%; height: 100vh;
      background: radial-gradient(circle at center, #1a0b2e 0%, #000000 100%);
      display: flex; align-items: center; justify-content: center; z-index: 9999;
      transition: opacity 0.8s, visibility 0.8s;
    }
    .login-box {
      background: rgba(10, 10, 15, 0.85); border: 1px solid rgba(147, 51, 234, 0.5);
      padding: 60px 50px; width: 400px; border-radius: 4px; backdrop-filter: blur(10px);
      text-align: center; position: relative; z-index: 10;
    }
    .input-field {
      width: 100%; background: transparent; border: none;
      border-bottom: 2px solid var(--primary-dim); color: var(--primary-dim);
      font-size: 24px; text-align: center; padding: 10px;
      font-family: 'JetBrains Mono', monospace; outline: none; margin-top: 30px;
      transition: all 0.2s; letter-spacing: 5px;
    }
    .login-btn {
      margin-top: 30px; background: var(--primary); color: #fff; border: none;
      padding: 12px 30px; font-family: 'JetBrains Mono', monospace; cursor: pointer; font-weight: bold;
    }
    
    .boot-screen {
      position: fixed; top: 0; left: 0; width: 100%; height: 100vh;
      background: #05000a; z-index: 9000; display: none; padding: 40px;
      font-family: 'JetBrains Mono', monospace; color: var(--accent); font-size: 13px; line-height: 1.6;
    }

    /* === 4. ë©”ì¸ ë ˆì´ì•„ì›ƒ === */
    .main-wrapper {
      display: flex; height: 100vh; opacity: 0; transition: opacity 1s;
      background: radial-gradient(circle at 80% 20%, rgba(60, 20, 80, 0.2), transparent 60%);
    }
    .sidebar {
      width: 260px; border-right: 1px solid rgba(255, 255, 255, 0.1); padding: 30px;
      background: rgba(0,0,0,0.6); backdrop-filter: blur(10px); display: flex; flex-direction: column;
    }
    .menu-item {
      padding: 15px 0; color: #666; cursor: pointer; font-family: 'JetBrains Mono', monospace;
      border-bottom: 1px solid rgba(255,255,255,0.05); transition: 0.3s;
    }
    .menu-item:hover { color: #aaa; padding-left: 5px; }
    .menu-item.active { color: #fff; border-left: 2px solid var(--primary); padding-left: 10px; text-shadow: 0 0 10px var(--primary); }
    
    .content-area { flex: 1; position: relative; overflow: hidden; }
    
    .section {
      display: none; padding: 50px 60px; height: 100%; overflow-y: auto;
      animation: fadeIn 0.4s ease-out;
    }
    .section.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .section-header h2 { font-size: 28px; color: #fff; display: flex; align-items: center; gap: 10px; }
    .section-header p { color: #888; margin-top: 10px; font-size: 14px; margin-bottom: 40px;}

    /* === íƒ­ 1: WORLDVIEW === */
    .timeline-graph {
      display: flex; align-items: flex-end; gap: 8px; height: 150px; margin-bottom: 50px;
      border-bottom: 1px solid #444; padding-bottom: 5px;
    }
    .t-bar {
      flex: 1; background: rgba(147, 51, 234, 0.2); position: relative; transition: height 1s;
    }
    .t-bar:hover { background: var(--primary); box-shadow: 0 0 10px var(--primary); }
    .t-bar::after {
      content: attr(data-year); position: absolute; bottom: -25px; left: 50%; transform: translateX(-50%);
      font-size: 10px; color: #666; font-family: 'JetBrains Mono';
    }

    .stats-container { display: flex; gap: 20px; margin-bottom: 50px; }
    .stat-box { flex: 1; background: var(--bg-panel); border: 1px solid rgba(255,255,255,0.1); padding: 20px; border-radius: 4px; }
    .stat-label { font-size: 12px; color: var(--primary-light); font-family: 'JetBrains Mono'; display: block; margin-bottom: 5px; }
    .stat-value { font-size: 32px; font-weight: 700; color: #fff; }
    
    .card-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; }
    .card {
      background: var(--bg-panel); border: 1px solid rgba(255, 255, 255, 0.1); padding: 25px;
      cursor: pointer; transition: 0.3s;
    }
    .card:hover { transform: translateY(-5px); border-color: var(--primary); background: rgba(40,40,50,0.9); }
    .card h3 { color: #fff; margin-bottom: 10px; font-size: 18px; }
    .card p { font-size: 13px; color: #aaa; }
    .card .tag { font-family: 'JetBrains Mono'; font-size: 10px; color: var(--primary-light); display: block; margin-bottom: 10px; }

    /* === íƒ­ 2: SYSTEM LOGS (ë³´ì•ˆ) === */
    /* ì ê¸ˆ í™”ë©´ */
    .log-lock-overlay {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(5, 5, 5, 0.98); z-index: 50;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      transition: opacity 0.5s;
    }
    .log-lock-overlay.unlocked { opacity: 0; pointer-events: none; }
    
    .terminal-container {
      display: flex; flex-direction: column; height: 100%;
    }
    .log-display {
      flex: 1; background: rgba(0,0,0,0.5); padding: 20px; border: 1px solid #333;
      overflow-y: auto; font-family: 'JetBrains Mono'; font-size: 12px; line-height: 1.8; color: #aaa;
    }
    .log-row { border-bottom: 1px solid #222; margin-bottom: 5px; padding-bottom: 5px; }
    .log-row.err { color: var(--danger); }
    .log-row.sec { color: #666; text-decoration: line-through; }

    /* í•˜ë‹¨ ì»¤ë§¨ë“œ ì…ë ¥ì°½ */
    .command-area {
      margin-top: 15px; background: #000; border: 1px solid var(--primary);
      padding: 15px; display: flex; align-items: center; gap: 10px;
    }
    .cmd-label { color: var(--primary); font-family: 'JetBrains Mono'; font-weight: bold; }
    .cmd-input {
      flex: 1; background: transparent; border: none; color: #fff;
      font-family: 'JetBrains Mono'; font-size: 14px; outline: none;
    }

    /* === íƒ­ 3: CONNECTION === */
    .conn-card {
      display: flex; align-items: center; gap: 20px; background: rgba(255,255,255,0.03);
      padding: 20px; margin-bottom: 15px; border-left: 3px solid #555; transition: 0.3s;
    }
    .conn-card:hover { border-left-color: var(--primary); background: rgba(147, 51, 234, 0.1); }
    .conn-card h4 { color: #fff; margin-bottom: 5px; }
    .conn-card p { font-size: 12px; color: #888; }

    /* === ìŠ¤í† ë¦¬ ë¦¬ë” (ì˜¤ë²„ë ˆì´) === */
    .story-overlay {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.95); z-index: 10000;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      opacity: 0; pointer-events: none; transition: opacity 0.8s;
    }
    .story-overlay.active { opacity: 1; pointer-events: auto; }
    
    /* í˜¸ëŸ¬ ëª¨ë“œ (REPACSE) */
    .story-overlay.horror { background: #1a0000; }
    .story-overlay.horror .story-text { color: var(--danger); text-shadow: 2px 2px 0 #000; font-family: 'JetBrains Mono'; }

    .story-text {
      font-family: 'Noto Serif KR', serif; font-size: 24px; line-height: 1.8;
      color: #fff; text-align: center; max-width: 800px; min-height: 120px;
    }
    .cursor::after { content: '|'; animation: blink 0.8s infinite; }
    @keyframes blink { 50% { opacity: 0; } }

  </style>
</head>
<body>

  <!-- ğŸµ ë®¤ì§ í”Œë ˆì´ì–´ (ë¹„ì£¼ì–¼ë¼ì´ì € í¬í•¨) -->
  <div class="music-player" id="musicPlayer">
    <div class="album-art" id="albumArt">ğŸµ</div>
    <div class="track-info">
      <div class="track-title" id="trackTitle">System Offline</div>
      <div class="track-artist" id="trackArtist">No Connection</div>
    </div>
    <!-- ì‹œê°ì  ì¬ìƒ íš¨ê³¼ -->
    <div class="visualizer" id="visualizer">
      <div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div>
    </div>
    <button class="ctrl-btn" onclick="togglePlay()" id="playBtn">â–¶</button>
    <audio id="audioSource"></audio>
  </div>

  <!-- 1. ë¡œê·¸ì¸ í™”ë©´ -->
  <div class="login-screen" id="loginScreen">
    <div id="seed-container"></div>
    <div class="login-box">
      <h1 style="color:#fff; font-size:24px; margin-bottom:10px;">ì¢…ìì˜ˆìˆ ê³ ë“±í•™êµ</h1>
      <p style="color:var(--primary-light); font-size:12px; letter-spacing:3px;">SECURE ARCHIVE SYSTEM v3.1</p>
      
      <input type="password" id="passwordInput" class="input-field" placeholder="ACCESS CODE" maxlength="10">
      
      <button class="login-btn" onclick="tryLogin()">CONNECT</button>
      <div id="errorMsg" style="color:var(--danger); font-size:12px; margin-top:15px; opacity:0;">âš ï¸ ACCESS DENIED</div>
    </div>
  </div>

  <!-- 2. ë¶€íŒ… í™”ë©´ -->
  <div class="boot-screen" id="bootScreen"></div>

  <!-- 3. ë©”ì¸ ì¸í„°í˜ì´ìŠ¤ -->
  <div class="main-wrapper" id="mainWrapper">
    <aside class="sidebar">
      <div>
        <h2 style="font-size: 14px; color: #fff; margin-bottom: 30px; letter-spacing: 2px;">JONGJA ARCHIVE</h2>
        <div class="menu-item active" onclick="switchTab('worldview', this)">WORLDVIEW</div>
        <div class="menu-item" onclick="switchTab('logs', this)">SYSTEM LOGS</div>
        <div class="menu-item" onclick="switchTab('connection', this)">CONNECTION</div>
      </div>
      <div style="font-size: 10px; color: #555; margin-top: auto;">
        SERVER: ONLINE<br>SECURITY: Lv.3
      </div>
    </aside>

    <main class="content-area">
      
      <!-- [íƒ­ 1] WORLDVIEW -->
      <section id="section-worldview" class="section active">
        <div class="section-header">
          <h2>ğŸŒ WORLDVIEW</h2>
          <p>í•™êµì˜ ê³µê°œ ì—­ì‚¬ ë° í˜„í™© ë°ì´í„°ì…ë‹ˆë‹¤.</p>
        </div>

        <h3 style="color:#fff; font-size:16px;">YEARLY ACTIVITY</h3>
        <div class="timeline-graph">
          <div class="t-bar" style="height: 30%;" data-year="1987"></div>
          <div class="t-bar" style="height: 45%;" data-year="1995"></div>
          <div class="t-bar" style="height: 60%;" data-year="2005"></div>
          <div class="t-bar" style="height: 40%;" data-year="2012"></div>
          <div class="t-bar" style="height: 80%; background:#c084fc;" data-year="2018"></div>
          <div class="t-bar" style="height: 20%; background:#555;" data-year="2024"></div>
        </div>

        <div class="stats-container">
          <div class="stat-box">
            <span class="stat-label">CURRENT STUDENTS</span>
            <span class="stat-value">632</span>
          </div>
          <div class="stat-box">
            <span class="stat-label">TOTAL GRADUATES</span>
            <!-- ê¸€ë¦¬ì¹˜ ìˆ«ì -->
            <span class="stat-value" id="gradCounter" style="color:var(--danger);">0</span>
          </div>
        </div>

        <h3 style="color:#fff; margin-bottom: 20px;">ARCHIVED RECORDS</h3>
        <div class="card-grid">
          <div class="card" onclick="openStory('kim')">
            <span class="tag">001. STUDENT</span>
            <h3>ê¹€ì„œìœ¤</h3>
            <p>ë¯¸ìˆ ê³¼ 2í•™ë…„. ìƒˆë²½ ë“±êµì™€ ìŠ¤ì¼€ì¹˜ë¶.</p>
          </div>
          <div class="card" onclick="openStory('lee')">
            <span class="tag">002. STUDENT</span>
            <h3>ì´ì¤€í˜</h3>
            <p>ìŒì•…ê³¼ 3í•™ë…„. 7ë²ˆ ì—°ìŠµì‹¤ì˜ í”¼ì•„ë…¸ ì†Œë¦¬.</p>
          </div>
          <div class="card" onclick="openStory('stairs')">
            <span class="tag">LOC. MAIN HALL</span>
            <h3>ì¤‘ì•™ ê³„ë‹¨</h3>
            <p>í•™ìƒë“¤ì´ ëˆ„êµ°ê°€ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ì¥ì†Œ.</p>
          </div>
          <div class="card" onclick="openStory('snow')">
            <span class="tag">EVENT LOG</span>
            <h3>ì²«ëˆˆì´ ë‚´ë¦° ë‚ </h3>
            <p>ìˆ˜ì—…ì´ 10ë¶„ ì§€ì—°ëœ ë‚ ì˜ ê¸°ë¡.</p>
          </div>
        </div>
      </section>

      <!-- [íƒ­ 2] SYSTEM LOGS (ë¹„ë°€) -->
      <section id="section-logs" class="section">
        <div class="terminal-container">
          <!-- ì ê¸ˆ í™”ë©´ -->
          <div class="log-lock-overlay" id="logLock">
            <h2 style="color:var(--danger); margin-bottom:20px;">ğŸ”’ RESTRICTED AREA</h2>
            <p style="color:#888; font-size:12px; margin-bottom:15px;">ENTER SECURITY KEY</p>
            <input type="password" id="seedInput" style="background:transparent; border:none; border-bottom:1px solid var(--danger); color:#fff; text-align:center; padding:5px; font-family:'JetBrains Mono'; outline:none; font-size:20px;" placeholder="Password">
          </div>

          <!-- ì‹¤ì œ ë¡œê·¸ ë‚´ìš© -->
          <div class="section-header">
            <h2 style="color:var(--danger);">âš ï¸ SYSTEM LOGS</h2>
            <p>ê¸°ë°€ ë°ì´í„° ì—´ëŒ êµ¬ì—­ì…ë‹ˆë‹¤. ëª¨ë“  ì ‘ê·¼ì€ ê¸°ë¡ë©ë‹ˆë‹¤.</p>
          </div>

          <div class="log-display">
            <div class="log-row">[SYSTEM] Connection established securely.</div>
            <div class="log-row err">[ERROR] Student #2024103 bio-data corrupted.</div>
            <div class="log-row">[INFO] Whale Company monthly funding received.</div>
            <div class="log-row sec">[HIDDEN] Block A underground facility access detected.</div>
            <div class="log-row">[INFO] CCTV footage auto-deleted (Reason: Security Protocol).</div>
            <div class="log-row err">[WARNING] 'ESCAPER' code usage detected in sector 4.</div>
            <div class="log-row sec">[HIDDEN] Subject survival rate: 0.00%</div>
            <div class="log-row">[SYSTEM] Waiting for administrator command...</div>
          </div>

          <!-- ìš°ì¸¡ í•˜ë‹¨ ì½”ë“œ ì…ë ¥ë€ -->
          <div class="command-area">
            <span class="cmd-label">ADMIN@ROOT:~$</span>
            <input type="text" id="secretCmd" class="cmd-input" placeholder="ENTER COMMAND..." autocomplete="off">
          </div>
        </div>
      </section>

      <!-- [íƒ­ 3] CONNECTION -->
      <section id="section-connection" class="section">
        <div class="section-header">
          <h2>ğŸ”— NETWORK CONNECTION</h2>
          <p>ì™¸ë¶€ ê¸°ê´€ ë° í˜‘ë ¥ ëŒ€ìƒê³¼ì˜ ì—°ê²° ìƒíƒœì…ë‹ˆë‹¤.</p>
        </div>

        <div class="conn-card">
          <div style="font-size:24px;">ğŸ«</div>
          <div>
            <h4>ì”¨ë‹¤ê³ ë“±í•™êµ (Ssida High)</h4>
            <p>Status: <span style="color:var(--accent)">CONNECTED</span> | êµë¥˜ í”„ë¡œê·¸ë¨ í™œì„±í™”</p>
          </div>
        </div>

        <div class="conn-card">
          <div style="font-size:24px;">ğŸ¢</div>
          <div>
            <h4>ì™¸ì€ì²­ê³ ë“±í•™êµ (Oeeuncheong High)</h4>
            <p>Status: <span style="color:yellow">UNSTABLE</span> | ë³´ì•ˆ í”„ë¡œí† ì½œ ì¶©ëŒ</p>
          </div>
        </div>

        <div class="conn-card" style="border-left-color:var(--primary);">
          <div style="font-size:24px;">ğŸ‹</div>
          <div>
            <h4>ê³ ë˜ì»´í¼ë‹ˆ (Whale Company)</h4>
            <p>Status: <span style="color:var(--accent)">SECURE LINK</span> | Main Sponsor</p>
            <p style="font-size:11px; margin-top:5px;">ì‹œì„¤ ìœ ì§€ë³´ìˆ˜ ë° ì—°êµ¬ë¹„ ì „ì•¡ ì§€ì› ì¤‘.</p>
          </div>
        </div>
      </section>

    </main>
  </div>

  <!-- ìŠ¤í† ë¦¬ ë¦¬ë” -->
  <div class="story-overlay" id="storyOverlay" onclick="nextSentence()">
    <div style="position:absolute; top:40px; right:40px; font-family:'JetBrains Mono'; color:#fff; font-size:12px;" id="storyProgress"></div>
    <div class="story-text" id="storyText"></div>
    <div style="position:absolute; bottom:50px; font-family:'JetBrains Mono'; font-size:12px; color:#666; animation:blink 1.5s infinite;">CLICK TO CONTINUE</div>
  </div>

  <script>
    /* === 1. ì‹œìŠ¤í…œ ì´ˆê¸°í™” & ë¡œê·¸ì¸ === */
    const pwdInput = document.getElementById('passwordInput');
    pwdInput.addEventListener('input', function() {
      const len = this.value.length;
      const light = 30 + (len * 7);
      this.style.color = `hsl(270, 100%, ${light}%)`;
      this.style.borderBottomColor = `hsl(270, 100%, ${light}%)`;
      if(len > 0) {
        this.style.textShadow = `0 0 ${len*2}px var(--primary)`;
      } else {
        this.style.textShadow = 'none';
      }
    });

    function tryLogin() {
      const val = document.getElementById('passwordInput').value.toUpperCase();
      if(val === 'ARCHIVE') {
        document.getElementById('loginScreen').style.opacity = 0;
        setTimeout(() => {
          document.getElementById('loginScreen').style.display = 'none';
          runBoot();
        }, 800);
      } else {
        const msg = document.getElementById('errorMsg');
        msg.style.opacity = 1;
        setTimeout(()=>msg.style.opacity=0, 2000);
      }
    }
    document.getElementById('passwordInput').addEventListener('keypress', (e)=>{if(e.key==='Enter') tryLogin()});

    function runBoot() {
      const boot = document.getElementById('bootScreen');
      const main = document.getElementById('mainWrapper');
      const player = document.getElementById('musicPlayer');
      boot.style.display = 'block';
      
      const lines = ["SYSTEM INIT...", "CONNECTING TO WHALE SERVER...", "DECRYPTING LOGS...", "ACCESS GRANTED."];
      let delay = 0;
      lines.forEach((line, i) => {
        delay += 500;
        setTimeout(() => {
          boot.innerHTML += `> ${line}<br>`;
          if(i === lines.length-1) {
            setTimeout(() => {
              boot.style.display = 'none';
              main.style.opacity = 1;
              player.style.opacity = 1;
            }, 800);
          }
        }, delay);
      });
    }

    /* === 2. íƒ­ ì „í™˜ === */
    function switchTab(id, el) {
      document.querySelectorAll('.menu-item').forEach(m => m.classList.remove('active'));
      el.classList.add('active');
      document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
      document.getElementById('section-' + id).classList.add('active');
    }

    /* === 3. SYSTEM LOGS ë³´ì•ˆ í•´ì œ (Seed) === */
    const seedInput = document.getElementById('seedInput');
    // input ì´ë²¤íŠ¸ë¡œ ë³€ê²½í•˜ì—¬ 'Seed' ì¹˜ìë§ˆì ì¦‰ì‹œ ë°˜ì‘
    seedInput.addEventListener('input', function() {
      if(this.value === 'Seed') {
        document.getElementById('logLock').classList.add('unlocked');
      }
    });

    /* === 4. í•˜ë‹¨ ì‹œí¬ë¦¿ ì»¤ë§¨ë“œ (ESCAPER / REPACSE) === */
    const secretCmd = document.getElementById('secretCmd');
    secretCmd.addEventListener('keypress', function(e) {
      if(e.key === 'Enter') {
        const cmd = this.value.toUpperCase();
        if(cmd === 'ESCAPER') openStory('escaper');
        else if(cmd === 'REPACSE') openStory('repacse');
        else {
          this.value = "COMMAND NOT RECOGNIZED";
          this.style.color = "red";
          setTimeout(()=>{ this.value=""; this.style.color="#fff"; }, 1000);
        }
      }
    });

    /* === 5. ê¸€ë¦¬ì¹˜ íš¨ê³¼ (ì¡¸ì—…ìƒ) === */
    setInterval(() => {
      const el = document.getElementById('gradCounter');
      // 5% í™•ë¥ ë¡œ 2000 ë˜ëŠ” ì—ëŸ¬ í‘œì‹œ
      if(Math.random() > 0.95) {
        el.innerText = Math.random() > 0.5 ? "2000" : "ERROR";
        el.style.textShadow = "2px 0 red, -2px 0 blue";
      } else {
        el.innerText = "0";
        el.style.textShadow = "none";
      }
    }, 100);

    /* === 6. ë®¤ì§ í”Œë ˆì´ì–´ ë¹„ì£¼ì–¼ë¼ì´ì € === */
    let isPlaying = false;
    const playlist = [{t:"Main Theme", a:"System"}, {t:"Piano Practice", a:"Lee Jun-hyeok"}];
    let trackIdx = 0;
    
    function togglePlay() {
      isPlaying = !isPlaying;
      const btn = document.getElementById('playBtn');
      const art = document.getElementById('albumArt');
      const visualizer = document.getElementById('visualizer');
      
      if(isPlaying) {
        btn.innerText = "â¸";
        art.classList.add('playing');
        visualizer.classList.add('playing'); // íŒŒí˜• ì›€ì§ì„ ì‹œì‘
      } else {
        btn.innerText = "â–¶";
        art.classList.remove('playing');
        visualizer.classList.remove('playing'); // íŒŒí˜• ë©ˆì¶¤
      }
    }

    /* === 7. ìŠ¤í† ë¦¬ ë¦¬ë” === */
    const storyDB = {
      'kim': ["ê¹€ì„œìœ¤. ë¯¸ìˆ ê³¼ 2í•™ë…„.", "ìƒˆë²½ ë“±êµë¥¼ ë°˜ë³µí•˜ê³  ìˆìŠµë‹ˆë‹¤.", "ê·¸ë…€ì˜ ìŠ¤ì¼€ì¹˜ë¶ì—ëŠ” í•™êµê°€ ë¬´ë„ˆì§€ëŠ” ê·¸ë¦¼ë§Œ ê·¸ë ¤ì ¸ ìˆìŠµë‹ˆë‹¤."],
      'lee': ["ì´ì¤€í˜. ìŒì•…ê³¼ 3í•™ë…„.", "7ë²ˆ ì—°ìŠµì‹¤ì—ì„œ ë‚˜ì˜¤ì§€ ì•ŠìŠµë‹ˆë‹¤.", "ê·¸ê°€ ì—°ì£¼í•˜ëŠ” ê³¡ì€ ì•…ë³´ì— ì—†ëŠ” ê³¡ì…ë‹ˆë‹¤."],
      'stairs': ["ì¤‘ì•™ ê³„ë‹¨.", "ê¸°ë‹¤ë¦¬ëŠ” í•™ìƒë“¤ì€ ë§ì§€ë§Œ, ì •ì‘ ë§Œë‚˜ëŠ” ì‚¬ëŒì€ ì—†ìŠµë‹ˆë‹¤.", "ê·¸ë“¤ì€ ëˆ„êµ¬ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ê±¸ê¹Œìš”?"],
      'snow': ["12ì›” 3ì¼ ì²«ëˆˆ.", "í•™ìƒë“¤ì€ ëˆˆì„ ë³´ë©° ì¢‹ì•„í–ˆì§€ë§Œ,", "êµì‚¬ë“¤ì€ ì°½ë¬¸ì„ ëª¨ë‘ ì ê°”ìŠµë‹ˆë‹¤."],
      'escaper': [
        "ì½”ë“œë„¤ì„: ESCAPER ì ‘ê·¼ ìŠ¹ì¸.",
        "ë³¸êµì˜ ì¡¸ì—…ë¥ ì´ 0%ì¸ ì´ìœ ëŠ” ê°„ë‹¨í•©ë‹ˆë‹¤.",
        "ì´ í•™êµëŠ” ì¸íë² ì´í„°ì…ë‹ˆë‹¤.",
        "í•™ìƒë“¤ì˜ ê°ì •ê³¼ ì˜ê°ì„ ë°ì´í„°ë¡œ ì¶”ì¶œí•˜ì—¬ ê³ ë˜ì»´í¼ë‹ˆì— ì „ì†¡í•©ë‹ˆë‹¤.",
        "ì¡¸ì—…ì€ ê³§ 'íê¸°'ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.",
        "ìš°ë¦¬ëŠ” ì¡¸ì—…í•˜ì§€ ì•Šê¸° ìœ„í•´ ë²„í‹°ê³  ìˆëŠ” ê²ƒì…ë‹ˆë‹¤."
      ],
      'repacse': [
        "ì‚´ë ¤ì¤˜.", "ì—¬ê¸°ì„œ ë‚˜ê°€ì•¼ í•´.", "ë²½ ì†ì— ëˆˆì´ ìˆì–´.",
        "ì„ ìƒë‹˜ë“¤ì€ ì‚¬ëŒì´ ì•„ë‹ˆì•¼.", "ì§€í•˜ 2ì¸µ ì‹¤í—˜ì‹¤ë¡œ ëŒë ¤ê°”ì–´.",
        "ë„ë§ì³.", "ì ˆëŒ€ ì¡¸ì—… ì‘í’ˆì„ ì™„ì„±í•˜ì§€ ë§ˆ.",
        "SYSTEM CRITICAL ERROR..."
      ]
    };
    
    let curStory = [];
    let curIdx = 0;
    let typing = false;

    function openStory(id) {
      if(!storyDB[id]) return;
      curStory = storyDB[id];
      curIdx = 0;
      const ov = document.getElementById('storyOverlay');
      ov.classList.add('active');
      if(id === 'repacse') ov.classList.add('horror');
      else ov.classList.remove('horror');
      showText();
    }

    function showText() {
      const t = document.getElementById('storyText');
      const p = document.getElementById('storyProgress');
      p.innerText = `REC ${curIdx+1}/${curStory.length}`;
      t.innerHTML = "";
      setTimeout(() => {
        startTyping(t, curStory[curIdx]);
      }, 200);
    }

    function startTyping(el, txt) {
      typing = true;
      let i = 0;
      el.innerHTML = '<span class="cursor"></span>';
      const timer = setInterval(() => {
        el.innerHTML = txt.substring(0, i+1) + '<span class="cursor"></span>';
        i++;
        if(i === txt.length) { clearInterval(timer); typing = false; }
      }, 70);
    }

    function nextSentence() {
      if(typing) return;
      curIdx++;
      if(curIdx >= curStory.length) document.getElementById('storyOverlay').classList.remove('active');
      else showText();
    }

    // ë°°ê²½ ì”¨ì•—
    setInterval(() => {
      const c = document.getElementById('seed-container');
      const s = document.createElement('div');
      s.innerText = 'ğŸŒ±'; s.className = 'seed';
      s.style.left = Math.random()*100+'%';
      s.style.animationDuration = (Math.random()*3+2)+'s';
      c.appendChild(s);
      setTimeout(()=>s.remove(), 5000);
    }, 150);

  </script>
</body>
</html>
